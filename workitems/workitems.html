---
layout: default
---

<head>
  <meta http-equiv='cache-control' content='no-cache'> 
  <meta http-equiv='expires' content='0'> 
  <meta http-equiv='pragma' content='no-cache'>
</head>


<style>
  #issueTable tr {
    height: 50px; /* Fixed row height */
  }

  #issueTable td {
    vertical-align: middle; /* Align content in the middle */
  }

  #issueTable .fas {
    margin-right: 10px; /* Space between icon and text */
  }
</style>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

<table id="issueTable" class="table table-bordered">
  <thead>
    <tr>
      <th>Issue Number</th>
      <th>Issue Title</th>
      <th>Branch</th>
      <th>Author</th>
      <th>Status</th>
      <th>Test Environment(s) Status</th>
      <th>Elapsed Time</th>
      <th>Link</th>
    </tr>
  </thead>
  <tbody>
  {% if site.data.issueStatusCombined %}
    {% assign sorted_issues = site.data.issueStatusCombined | sortBy: 'issue_number' | reverse %}
    {% for issue in sorted_issues %}
      <tr>
        <td>{{ issue.issue_number }}</td>
         <td>{{ issue.issue_details.title }}</td>
         <td>{{ issue.branch }}</td>
         <td>{{ issue.issue_details.user.login }}</td>
         <td>
          {% case issue.status %}
            {% when 'locked/applying patches' %}
              <i class="fas fa-vials status-icon"></i>
              <i class="fas fa-tasks status-icon"></i>
               Patching in test work item
            {% when 'validation' %}
              <i class="fas fa-tasks status-icon"></i>
               Checks In Progress
            {% when 'validated' %}
              <i class="fas fa-tasks status-icon"></i>
              In Review
             {% when 'forced' %}
              <i class="fas fa-person-through-window status-icon"></i>
              Force Pushed
            {% when 'locked' %}
              <i class="fas fa-vials status-icon"></i>
              In Testing
             {% when 'unlocked' %}
              <i class="fas fa-tasks status-icon"></i>
              In Review
            {% when 'build' %}
              <i class="fas fa-hammer status-icon"></i>
              {{ issue.status | capitalize }}
          {% endcase %}
        </td>
         <td>
          {% case issue.status %}
            {% when 'forced' %}
              <i class="fas fa-person-through-window status-icon"></i>
              Force Pushed
            {% when 'locked/applying patches' %}
             <i class="fas fa-lock status-icon"></i>
               Locked for Testing
            {% when 'locked' %}
              <i class="fas fa-lock status-icon"></i>
              Locked for Testing ( {{ issue.domain }} )
          {% endcase %}
        </td>
        <td><span id="elapsed-time-{{ forloop.index }}"></span></td>
        <td>
          <a href="{{ issue.issue_details.html_url }}" target="_blank">View Issue</a>
        </td>
      </tr>   
    {% endfor %}
   {% endif %}
  </tbody>
</table>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
   $(document).ready(function() {
    $('#issueTable').DataTable({
      "order": [[0, "desc"]] ,
      "paging":false,
    });
  });
 function formatElapsedTime(milliseconds) {
    var seconds = Math.floor(milliseconds / 1000);
    var minutes = Math.floor(seconds / 60);
    var hours = Math.floor(minutes / 60);
    var days = Math.floor(hours / 24);

    seconds = seconds % 60;
    minutes = minutes % 60;
    hours = hours % 24;

    return `${days}d ${hours}h ${minutes}m ${seconds}s`;
  }

  function updateElapsedTimes() {
    var now = new Date();
    {% for issue in site.data.issueStatusCombined%}
      var createdTime = new Date("{{ issue.issue_details.created_at }}");
      var elapsedTime = now - createdTime;
      document.getElementById('elapsed-time-{{ forloop.index }}').innerText = formatElapsedTime(elapsedTime);
    {% endfor %}
  }

  // Update elapsed time every second
  setInterval(updateElapsedTimes, 1000);
</script>
